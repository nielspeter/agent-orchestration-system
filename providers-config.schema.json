{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Provider Configuration",
  "description": "Configuration for LLM providers and models",
  "type": "object",
  "properties": {
    "_comment": {
      "type": "string",
      "description": "Comments for documentation"
    },
    "_comment2": {
      "type": "string",
      "description": "Additional comments"
    },
    "_comment3": {
      "type": "string",
      "description": "Additional comments"
    },
    "behaviorPresets": {
      "type": "object",
      "description": "Behavior presets that combine temperature and top_p settings",
      "patternProperties": {
        "^[a-z]+$": {
          "type": "object",
          "properties": {
            "temperature": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Sampling temperature (0.0 to 1.0)"
            },
            "top_p": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Nucleus sampling parameter (0.0 to 1.0)"
            },
            "description": {
              "type": "string",
              "description": "Description of this preset's use case"
            }
          },
          "required": ["temperature", "top_p"]
        }
      }
    },
    "defaultModel": {
      "type": "string",
      "description": "Default model to use when none is specified"
    },
    "fallbackProvider": {
      "type": "string",
      "description": "Fallback provider to use when no pattern or alias matches the model"
    },
    "providers": {
      "type": "object",
      "description": "Provider definitions",
      "patternProperties": {
        "^[a-z0-9-]+$": {
          "type": "object",
          "properties": {
            "type": {
              "enum": ["native", "openai-compatible"],
              "description": "Provider implementation type"
            },
            "className": {
              "type": "string",
              "description": "Class name for native providers"
            },
            "baseURL": {
              "type": "string",
              "format": "uri",
              "description": "API endpoint URL"
            },
            "apiKeyEnv": {
              "type": "string",
              "description": "Environment variable name for API key"
            },
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Whether this provider is enabled"
            },
            "optional": {
              "type": "boolean",
              "default": false,
              "description": "Whether to fail if provider is not configured"
            },
            "headers": {
              "type": "object",
              "description": "Additional HTTP headers",
              "additionalProperties": {
                "type": "string"
              }
            },
            "dynamicModels": {
              "type": "boolean",
              "default": false,
              "description": "Whether provider supports any model dynamically"
            },
            "routing": {
              "type": "object",
              "description": "OpenRouter-specific routing configuration",
              "properties": {
                "order": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Specific provider order to try"
                },
                "only": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Only use these specific providers"
                },
                "allowFallbacks": {
                  "type": "boolean",
                  "description": "Allow fallback to other providers if preferred ones fail"
                },
                "sort": {
                  "type": "string",
                  "enum": ["price", "latency", "throughput"],
                  "description": "Sort providers by: price (cheapest first), latency (fastest first), or throughput (highest capacity first)"
                }
              }
            },
            "models": {
              "type": "array",
              "description": "Available models for this provider",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "Model identifier"
                  },
                  "contextLength": {
                    "type": "number",
                    "description": "Maximum context length in tokens"
                  },
                  "maxOutputTokens": {
                    "type": "number",
                    "description": "Maximum tokens to generate in response",
                    "default": 4096
                  },
                  "temperature": {
                    "type": "number",
                    "description": "Sampling temperature (0.0 to 1.0) - lower is more deterministic, better for agents",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 0.5
                  },
                  "pricing": {
                    "type": "object",
                    "properties": {
                      "input": {
                        "type": "number",
                        "description": "Cost per 1K input tokens in USD"
                      },
                      "output": {
                        "type": "number",
                        "description": "Cost per 1K output tokens in USD"
                      }
                    },
                    "description": "Pricing information"
                  },
                  "description": {
                    "type": "string",
                    "description": "Model description"
                  },
                  "examples": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Example model names for dynamic providers"
                  },
                  "capabilities": {
                    "type": "object",
                    "description": "Model capabilities including thinking/reasoning support",
                    "properties": {
                      "thinking": {
                        "oneOf": [
                          { "type": "boolean" },
                          { "enum": ["automatic", "discovery"] }
                        ],
                        "description": "Thinking support: true/false for static, 'automatic' for o1/o3, 'discovery' for runtime detection"
                      },
                      "thinkingMinBudget": {
                        "type": "number",
                        "description": "Minimum thinking budget in tokens"
                      },
                      "thinkingMaxBudget": {
                        "type": "number",
                        "description": "Maximum thinking budget in tokens"
                      },
                      "thinkingDefaultBudget": {
                        "type": "number",
                        "description": "Default thinking budget in tokens when not specified"
                      },
                      "thinkingNotes": {
                        "type": "string",
                        "description": "Notes about thinking implementation for this model"
                      }
                    }
                  }
                },
                "required": ["id"]
              }
            }
          },
          "required": ["type", "apiKeyEnv", "models"]
        }
      }
    },
    "modelPatterns": {
      "type": "array",
      "description": "Patterns for matching models to providers",
      "items": {
        "type": "object",
        "properties": {
          "pattern": {
            "type": "string",
            "description": "Regular expression pattern"
          },
          "provider": {
            "type": "string",
            "description": "Provider to use for matching models"
          },
          "description": {
            "type": "string",
            "description": "Description of this pattern rule"
          }
        },
        "required": ["pattern", "provider"]
      }
    }
  },
  "required": ["providers"]
}
